#!/usr/bin/bash
#taskbar script

TERM="st"
tear=$(xrandr --prop | grep TearFree | grep -E '(on|off)' | awk '{print $2}')
tearn=$( [ $tear = "on" ] && echo off || echo on)

choices=(
"htop"
"calcurse"
"pavucontrol"
"bluetooth"
"tearing $tearn"
"keymap-fix"
"exit"
)

while true; do
	sel=$(printf '%s\n' "${choices[@]}" | rofi -dmenu -p "taskbar: ")
	
	case $sel in
		"htop")
			$TERM "htop"
			exit 0
			;;
		"calcurse")
			$TERM "calcurse"
			exit 0
			;;
		"pavucontrol")
			pavucontrol & exit 0
		 	;;
		"bluetooth")
			bluetooth
			if [[ $? -eq 0 ]]; then
				exit 0
			fi
		 	;;
		"tearing $tearn")
			xrandr --output HDMI-A-0 --set TearFree $tearn
			exit 0
			;;		
		"keymap-fix")
			setxkbmap -layout us,ru -option grp:alt_shift_toggle
			exit 0
			;;
		"exit")
			exit 0
		 	;;
	esac

	if [[ -z $sel ]]; then
		exit 0
	fi
done
